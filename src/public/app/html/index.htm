<!DOCTYPE html>
<html lang="fr-FR">

<head>
    <link rel="alternate" hreflang="fr" href="https://app.licence-informatique-lemans.tk/">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Aytixel">
    <meta name="description" content="Web App non officiel de la Licence Informatique du Mans">
    <meta name="theme-color" content="#009c9a">
    <title>Licence Informatique LeMans - Web App</title>
    <link rel="preload stylesheet" as="style" type="text/css" href="/css/font.css">
    <link rel="preload stylesheet" as="style" type="text/css" href="/css/palette.css">
    <link rel="preload stylesheet" as="style" type="text/css" href="/css/index.css">
    <link rel="preload stylesheet" as="style" type="text/css" href="/css/planning-components.css">
    <script>
        function debounce(callback, delay) {
            let timer;

            return function () {
                const args = arguments;
                const context = this;

                clearTimeout(timer);

                timer = setTimeout(() => callback.apply(context, args), delay)
            }
        }
        function keep_only_date(date) {
            time = new Date(date).getTime();

            return new Date(time - (time % (1000 * 60 * 60 * 24)));
        }
        function compare_date(date1, date2) {
            return new Date(date2).getTime() - new Date(date1).getTime()
        }
        function add_days(date, day) {
            return new Date(new Date(date).getTime() + (day * 1000 * 60 * 60 * 24))
        }

        let planning_resources_name;
        let planning_resources_type;
        const planning_resources_loaded = (async () => {
            planning_resources_name = await (await fetch("https://api.licence-informatique-lemans.tk/v2/planning-resources-name.json")).json();
            planning_resources_type = await (await fetch("https://api.licence-informatique-lemans.tk/v2/planning-resources-type.json")).json();

            return true;
        })();

        if (!Array.isArray(JSON.parse(localStorage.getItem("favorites")))) localStorage.setItem("favorites", "[]");

        if (screen?.orientation?.lock !== undefined) screen.orientation.lock("natural").catch(() => console.log("Can't lock screen orientation !"));

        let loader_count = 0;

        function start_loader() {
            loader_count++;

            document.getElementById("menu-button").classList.add("loading");
        }
        function end_loader() {
            document.getElementById("menu-button").classList.toggle("loading", loader_count = Math.max(0, loader_count - 1));
        }
    </script>
    <script src="https://unpkg.com/mol_time_all/web.js" async></script>
    <script src="/js/scroll.js" defer></script>
    <script src="/js/scroll-snap.js" defer></script>
    <script src="/js/izly.js" defer></script>
    <script src="/js/component.js" defer></script>
    <script src="/js/index.js" async></script>
    <script src="https://cdn.jsdelivr.net/npm/@alpinejs/intersect@3.13.0/dist/cdn.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@alpinejs/persist@3.13.0/dist/cdn.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@alpinejs/mask@3.13.0/dist/cdn.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.0/dist/cdn.min.js" defer></script>
</head>

<body x-data="{offline: !navigator.onLine, izly_connected: false}" @offline.window="offline = true"
    @online.window="offline = false" :class="offline && 'offline'">
    <div id="top-bar">
        <h1>Pas de formation</h1>
        <h2>sélectionner</h2>
        <a href="#" id="menu-button" aria-label="Menu" @pointerdown.prevent @click.prevent="open_menu">
            <div></div>
        </a>
    </div>
    <dialog id="menu" x-ref="menu" @click="close_menu">
        <ul>
            <li id="izly" x-data="izly" x-init="update" x-model="izly_connected" x-modelable="connected">
                <details>
                    <summary>
                        <h3>Izly</h3>
                    </summary>
                    <form @submit.prevent="submit" x-show="!connected">
                        <input type="email" name="email" required placeholder="Email du compte Izly" x-model="email">
                        <input type="password" name="code" required placeholder="Code secret" x-model="code"
                            x-mask="999999">
                        <div id="izly-tos">
                            <input type="checkbox" required aria-label="Condition d'utilisation case à cocher">
                            <details>
                                <summary>Condition d'utilisation</summary>
                                Votre email et code secret seront envoyés aux serveurs à chaque fois, mais jamais ils ne
                                seront enregistrés, de même que tout autre information récupérer depuis votre compte
                                Izly. Toutes vos informations sont stockées localement sur votre appareil. Toutefois
                                nous ne pouvons garantir qu'il n'y aura aucun problème avec votre compte Izly. Utilisez
                                donc cette fonctionnalité à vos risque et péril.
                            </details>
                        </div>
                        <input type="submit" value="Se connecter">
                    </form>
                    <div id="izly-pay" x-show="connected">
                        <img id="izly-qrcode" :src="qrcode" alt="Qrcode Izly">
                        <div id="izly-email" x-text="email"></div>
                        <div>Solde : <span x-text="balance"></span> €</div>
                        <input @click="switch_account" type="submit" value="Changer de compte">
                    </div>
                </details>
            </li>
            <li>
                <h3>Formations</h3>
                <ul x-data="planning_selector('study-level')">
                    <template x-for="level in levels" :key="level">
                        <details>
                            <summary x-text="planning_resources_name[level].name"></summary>
                            <ul>
                                <template x-for="(group, group_index) in planning_resources_name[level].name_list"
                                    :key="group">
                                    <li @click="switch_planning(level, group_index)">
                                        <svg @click.stop="select_favorite(level, group_index)"
                                            :class="in_favorites(level, group_index) &&'selected'"
                                            xmlns="http://www.w3.org/2000/svg"
                                            viewBox="-4 -10 584 567"><!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                                            <path
                                                d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
                                        </svg>
                                        <span x-text="group"></span>
                                    </li>
                                </template>
                            </ul>
                        </details>
                    </template>
                </ul>
            </li>
            <li>
                <h3>Bâtiment</h3>
                <ul x-data="planning_selector('place')">
                    <template x-for="level in levels" :key="level">
                        <details>
                            <summary x-text="planning_resources_name[level].name"></summary>
                            <ul>
                                <template x-for="(group, group_index) in planning_resources_name[level].name_list"
                                    :key="group">
                                    <li @click="switch_planning(level, group_index)">
                                        <svg @click.stop="select_favorite(level, group_index)"
                                            :class="in_favorites(level, group_index) &&'selected'"
                                            xmlns="http://www.w3.org/2000/svg"
                                            viewBox="-4 -10 584 567"><!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
                                            <path
                                                d="M316.9 18C311.6 7 300.4 0 288.1 0s-23.4 7-28.8 18L195 150.3 51.4 171.5c-12 1.8-22 10.2-25.7 21.7s-.7 24.2 7.9 32.7L137.8 329 113.2 474.7c-2 12 3 24.2 12.9 31.3s23 8 33.8 2.3l128.3-68.5 128.3 68.5c10.8 5.7 23.9 4.9 33.8-2.3s14.9-19.3 12.9-31.3L438.5 329 542.7 225.9c8.6-8.5 11.7-21.2 7.9-32.7s-13.7-19.9-25.7-21.7L381.2 150.3 316.9 18z" />
                                        </svg>
                                        <span x-text="group"></span>
                                    </li>
                                </template>
                            </ul>
                        </details>
                    </template>
                </ul>
            </li>
            <li>
                <h3>Salle disponible</h3>
                <ul id="room" x-data="free_room" @update-free-room.window="update">
                    <template x-for="place in Object.keys(list)" :key="place">
                        <details>
                            <summary x-text="planning_resources_name[place].name"></summary>
                            <ul>
                                <template x-for="room in list[place]" :key="room.room">
                                    <li>
                                        <div x-text="planning_resources_name[place].name_list[room.room]"></div>
                                        <template x-if="room.time_left">
                                            <div class="time-left">disponible encore :
                                                <span
                                                    x-text="date_to_time_intl.format(new Date(room.time_left))"></span>
                                            </div>
                                        </template>
                                    </li>
                                </template>
                            </ul>
                        </details>
                    </template>
                </ul>
            </li>
        </ul>
    </dialog>
    <div x-data="planning_viewer" @resize.window.passive="resize">
        <div class="left-bar" x-show="show_left_bar" x-transition.duration.300ms.opacity></div>
        <div class="container" x-ref="container" @scroll.passive="scroll">
            <template x-for="day_data in data.days" :key="day_data.date">
                <div x-data="day_viewer(day_data)" :data-date="day_data.date"
                    @resize.window.passive="update_indicator_bars">
                    <time>
                        <h2 x-text="day_date_format.toString('D Mon YYYY')"></h2>
                        <h3 x-text="day_date_format.toString('WD')"></h3>
                    </time>
                    <div class="top-bar" x-show="show_top_bar" x-transition.duration.300ms.opacity></div>
                    <div class="container" x-ref="container" @scroll.passive="update_indicator_bars">
                        <template x-for="lesson_data in data.lessons"
                            :key="lesson_data.start_date + lesson_data.end_date">
                            <div tabindex="0" x-data="lesson_viewer(lesson_data)" :class="show && 'show'"
                                :style="get_background(data.title)"
                                @click="show = true; $nextTick(() => $el.scrollIntoView({ inline: 'center', behavior: 'smooth' }));"
                                @focusin="show = true" @click.outside="show = false" @focusout="show = false">
                                <h3 x-text="data.title"></h3>
                                <p x-html="data.description.join('<br>')"></p>
                                <span class="bottom-bar">
                                    <time :datetime="data.start_date"
                                        x-text="new $mol_time_moment(data.start_date).toString('hh:mm')"></time> - <time
                                        :datetime="data.end_date"
                                        x-text="new $mol_time_moment(data.end_date).toString('hh:mm')"></time>
                                    <div class="rooms" x-html="show ? data.rooms.join('<br>') : data.rooms.join(', ')">
                                    </div>
                                </span>
                            </div>
                        </template>
                    </div>
                    <div class="bottom-bar" x-show="show_bottom_bar" x-transition.duration.300ms.opacity></div>
                </div>
            </template>
        </div>
        <div class="right-bar" x-show="show_right_bar" x-transition.duration.300ms.opacity></div>
    </div>
</body>

</html>