document.addEventListener("alpine:init",(()=>{Alpine.data("izly",(function(){return{connected:!1,code:"",email:this.$persist(""),encrypted_code:this.$persist(""),balance:this.$persist(""),qrcode:this.$persist(""),async update(){if(this.email.length&&this.encrypted_code.length){if(navigator.onLine)try{const[{Src:t},e]=await(await fetch("https://api.licence-informatique-lemans.tk/v2/izly-qrcode.json",{method:"post",body:JSON.stringify({email:this.email,code:this.encrypted_code})})).json();this.qrcode=t,this.balance=e.toString().replace(".",",")}catch{}return await this.$nextTick(),void(this.connected=!0)}this.connected=!1},switch_account(){this.email=this.code=this.encrypted_code=this.balance=this.qrcode="",this.update()},submit(){const t=[...this.code].reduce(((t,e)=>({x:t.x+(!+e&&!t.c),c:t.c+ +e})),{x:0,c:0}).x,e=8+Math.round(28*Math.random());this.encrypted_code=e+(+this.code+this.email.length).toString(e)+e.toString().length+t,this.update()}}}))}));
